{#
 * Telegram core system
 * @version 172 
 * @author David Galet
 * @link http://www.davidev.it/
#}
 {{ header }}{{ column_left }}
 <div id="content">
     <div class="page-header">
         <div class="container-fluid">
             <div class="pull-right">
             <button type="submit" form="form-module" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary"><i class="fa fa-save"></i></button>
             <a href="{{ cancel }}" data-toggle="tooltip" title="{{ button_cancel }}" class="btn btn-default"><i class="fa fa-reply"></i></a></div>
             <h1>{{ heading_title }}</h1>
             <ul class="breadcrumb">
             {% for breadcrumb in breadcrumbs %}
             <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
             {% endfor %}
             </ul>
         </div>
     </div>
     <div class="container-fluid">
     {% if error_warning %}
         <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}
             <button type="button" class="close" data-dismiss="alert">&times;</button>
         </div>
     {% endif %}
     {% if error_token %}
         <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_token }}
             <button type="button" class="close" data-dismiss="alert">&times;</button>
         </div>
     {% endif %}
     {% if error_username %}
         <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_username }}
             <button type="button" class="close" data-dismiss="alert">&times;</button>
         </div>
     {% endif %}
     {% if error_existence %}
         <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_existence }}
             <button type="button" class="close" data-dismiss="alert">&times;</button>
         </div>
     {% endif %}
     {% if error_coincidence %}
         <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_coincidence }}
             <button type="button" class="close" data-dismiss="alert">&times;</button>
         </div>
     {% endif %}
     {% if error_https %}
         <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_https }}
             <button type="button" class="close" data-dismiss="alert">&times;</button>
         </div>
     {% endif %}
     {% if error_presence %}
         <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_presence }}
             <button type="button" class="close" data-dismiss="alert">&times;</button>
         </div>
     {% endif %}
         <div class="panel panel-default">
             <div class="panel-heading">
             <h3 class="panel-title"><i class="fa fa-pencil"></i> {{ text_edit }}</h3>
             </div>
             <div class="panel-body">
                 <form action="{{ action }}" method="post" enctype="multipart/form-data" id="form-module" class="form-horizontal">
                    {# status #}
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-status">{{ entry_status }}</label>
                        <div class="col-sm-10">
                            <select name="telegram_bot_core_status" id="input-status" class="form-control">
                            {% if telegram_bot_core_status %}
                            <option value="1" selected="selected">{{ text_enabled }}</option>
                            <option value="0">{{ text_disabled }}</option>
                            {% else %}
                            <option value="1">{{ text_enabled }}</option>
                            <option value="0" selected="selected">{{ text_disabled }}</option>
                            {% endif %}
                            </select>
                        </div>
                    </div>
                    {# token bot#}
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-limit">{{ entry_token }}</label>
                        <div class="col-sm-10">
                        <input type="text" name="telegram_bot_core_token" value="{{ telegram_bot_core_token }}" placeholder="{{ entry_token }}" id="input-limit" class="form-control" />
                        </div>
                    </div>
                    {# username bot #}
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-limit">{{ entry_username }}</label>
                        <div class="col-sm-10">
                        <input type="text" name="telegram_bot_core_name" value="{{ telegram_bot_core_name }}" placeholder="{{ entry_username }}" id="input-limit" class="form-control" />
                        </div>
                    </div>
                    {# Select store refer #}
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-bot_store_select">{{ entry_store }}</label>
                        <div class="col-sm-10">
                            <select name="telegram_bot_core_store" id="input-bot_store_select" class="form-control">
                            {% for store in stores %}
                                {% if telegram_bot_core_store == store.store_id %}
                                <option value="{{ store.store_id }}" selected="selected">{{ store.name }}</option>
                                {% else %}
                                <option value="{{ store.store_id }}">{{ store.name }}</option>
                                {% endif %}
                            {% endfor %} %}
                            </select>
                        </div>
                    </div>
                    {# Select languages #}
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-bot_languages_select">{{ entry_language }}</label>
                        <div class="col-sm-10">
                            <select name="telegram_bot_core_language" id="input-bot_languages_select" class="form-control">
                            {% for language in languages %}
                                {% if telegram_bot_core_language == language.language_id %}
                                <option value="{{ language.language_id }}" selected="selected">{{ language.name }}</option>
                                {% else %}
                                <option value="{{ language.language_id }}">{{ language.name }}</option>
                                {% endif %}
                            {% endfor %}
                            </select>
                        </div>
                    </div>
                    {# Select Default item #}
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-limit">{{ entry_thanks_message }}</label>
                        <div class="col-sm-10">
                        <input type="text" name="telegram_bot_core_thanks_message" value="{{ telegram_bot_core_thanks_message }}" placeholder="{{ entry_thanks_message }}" id="input-limit" class="form-control" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-limit">{{ entry_not_found }}</label>
                        <div class="col-sm-10">
                        <input type="text" name="telegram_bot_core_not_found" value="{{ telegram_bot_core_not_found }}" placeholder="{{ entry_not_found }}" id="input-limit" class="form-control" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-limit">{{ entry_start_heder }}</label>
                        <div class="col-sm-10">
                        <input type="text" name="telegram_bot_core_start_heder" value="{{ telegram_bot_core_start_heder }}" placeholder="{{ entry_start_heder }}" id="input-limit" class="form-control" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-limit">{{ entry_start_footer }}</label>
                        <div class="col-sm-10">
                        <input type="text" name="telegram_bot_core_start_footer" value="{{ telegram_bot_core_start_footer }}" placeholder="{{ entry_start_footer }}" id="input-limit" class="form-control" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-limit">{{ entry_help_header }}</label>
                        <div class="col-sm-10">
                        <input type="text" name="telegram_bot_core_help_header" value="{{ telegram_bot_core_help_header }}" placeholder="{{ entry_help_header }}" id="input-limit" class="form-control" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-limit">{{ entry_help_footer }}</label>
                        <div class="col-sm-10">
                        <input type="text" name="telegram_bot_core_help_footer" value="{{ telegram_bot_core_help_footer }}" placeholder="{{ entry_help_footer }}" id="input-limit" class="form-control" />
                        </div>
                    </div>
                    {# Select store refer #}
                    {% if command_values %}
                    <fieldset>
                        <legend>{{ entry_command_list }}</legend>
                        <table id="commands-value" class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                            <td class="text-left required">{{ entry_command_name_file }}</td>
                            <td class="text-center">{{ entry_command_nickname }}</td>
                            <td class="text-center">{{ entry_command_description }}</td>
                            <td class="text-right">{{ entry_command_status }}</td>
                            </tr>
                        </thead>
                        <tbody>
                        
                        {% set command_value_row = 0 %}
                        {% for command_value in command_values %}
                        <tr id="command-value-row{{ command_value_row }}">
                            <td class="text-center">{{ command_value.name }}</td>
                            <td class="text-center"><input type="hidden" name="telegram_bot_core_command_value[{{ command_value_row }}][command_file]" value="{{ command_value.name }}" />
                                {% for language in languages %}
                                <div class="input-group"><span class="input-group-addon"><img src="language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}" /></span>
                                    <input type="text" name="telegram_bot_core_command_value[{{ command_value_row }}][command_value_description][{{ language.language_id }}][name]" value="{{ command_value.command_value_description[language.language_id] ? command_value.command_value_description[language.language_id].name }}" placeholder="{{ entry_command_nickname }}" class="form-control" />
                                </div>
                                {% endfor %}
                            </td>
                            <td class="text-center"><input type="hidden" name="telegram_bot_core_command_value[{{ command_value_row }}][description]" value="{{ command_value.description }}" />
                                {% for language in languages %}
                                <div class="input-group"><span class="input-group-addon"><img src="language/{{ language.code }}/{{ language.code }}.png" title="{{ language.description }}" /></span>
                                    <input type="text" name="telegram_bot_core_command_value[{{ command_value_row }}][command_value_description][{{ language.language_id }}][description]" value="{{ command_value.command_value_description[language.language_id] ? command_value.command_value_description[language.language_id].description }}" placeholder="{{ entry_command_description }}" class="form-control" />
                                </div>
                                {% endfor %}
                            </td>
                            <td>
                                <select name="telegram_bot_core_command_value[{{ command_value_row }}][status]" class="form-control">
                                    {% if command_value.status == 1 %}
                                    <option value="1" selected="selected">{{ text_enabled }}</option>
                                    <option value="0">{{ text_disabled }}</option>
                                    {% else %}
                                    <option value="1">{{ text_enabled }}</option>
                                    <option value="0" selected="selected">{{ text_disabled }}</option>
                                    {% endif %}
                                </select>
                            </td>
                        </tr>

                        {% set command_value_row = command_value_row + 1 %}
                        {% endfor %}
                        </tbody>
                        
                        <tfoot>
                            <tr>
                            <td colspan="3"></td>
                            </tr>
                        </tfoot>
                        </table>
                    </fieldset>
                    {% endif %}

                    {# trigger #}
                    <fieldset>
                        <legend>{{ test_trigger }}</legend>
                        <table id="trigger-value" class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                            <td class="text-left required">{{ entry_keyword_a }}</td>
                            <td class="text-center">{{ entry_keyword_b }}</td>
                            <td class="text-right">{{ entry_role }}</td>
                            <td class="text-right">{{ entry_answer }}</td>
                            <td></td>
                            </tr>
                        </thead>
                        <tbody>
                        
                        {% set trigger_value_row = 0 %}
                        {% for trigger_value in trigger_values %}
                        <tr id="trigger-value-row{{ trigger_value_row }}">
                            
                            <td class="text-center">
                            {% for language in languages %}
                            <div class="input-group"><span class="input-group-addon"><img src="language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}" /></span>
                                <input type="text" name="telegram_bot_core_trigger_value[{{ trigger_value_row }}][trigger_value_keyword_a][{{ language.language_id }}][value]" value="{{ trigger_value.trigger_value_keyword_a[language.language_id] ? trigger_value.trigger_value_keyword_a[language.language_id].value }}" placeholder="{{ entry_keyword_a }}" class="form-control" />
                            </div>
                            {% endfor %}</td>

                            <td class="text-center">
                            {% for language in languages %}
                            <div class="input-group"><span class="input-group-addon"><img src="language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}" /></span>
                                <input type="text" name="telegram_bot_core_trigger_value[{{ trigger_value_row }}][trigger_value_keyword_b][{{ language.language_id }}][value]" value="{{ trigger_value.trigger_value_keyword_b[language.language_id] ? trigger_value.trigger_value_keyword_b[language.language_id].value }}" placeholder="{{ entry_keyword_b }}" class="form-control" />
                            </div>
                            {% endfor %}</td>

                            <td class="text-right">
                                <select name="telegram_bot_core_trigger_value[{{ trigger_value_row }}][role]" class="form-control">
                                {% if trigger_value.role == 1 %}
                                <option value="1" selected="selected">{{ text_or }}</option>
                                <option value="0">{{ text_and }}</option>
                                {% else %}
                                <option value="1">{{ text_or }}</option>
                                <option value="0" selected="selected">{{ text_and }}</option>
                                {% endif %}
                                </select>
                            </td>

                            <td class="text-center">
                            {% for language in languages %}
                            <div class="input-group"><span class="input-group-addon"><img src="language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}" /></span>
                                <input type="text" name="telegram_bot_core_trigger_value[{{ trigger_value_row }}][trigger_value_description][{{ language.language_id }}][value]" value="{{ trigger_value.trigger_value_description[language.language_id] ? trigger_value.trigger_value_description[language.language_id].value }}" placeholder="{{ entry_answer }}" class="form-control" />
                            </div>
                            {% endfor %}</td>

                            <td class="text-right"><button type="button" onclick="$('#trigger-value-row{{ trigger_value_row }}').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>
                        </tr>
                        {% set trigger_value_row = trigger_value_row + 1 %}
                        {% endfor %}
                            </tbody>
                        
                        <tfoot>
                            <tr>
                            <td colspan="4"></td>
                            <td class="text-right"><button type="button" onclick="addOptionValue();" data-toggle="tooltip" title="{{ button_trigger_value_add }}" class="btn btn-primary"><i class="fa fa-plus-circle"></i></button></td>
                            </tr>
                        </tfoot>
                        </table>
                    </fieldset>

                    {# Link #}
                    {% if telegram_bot_core_cron_url %}
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-data-feed">{{ entry_data_link_cron }}</label>
                        <div class="col-sm-10">
                            <textarea rows="1" id="input-data-feed" class="form-control" readonly>{{ telegram_bot_core_cron_url }}</textarea>
                        </div>
                    </div>
                    {% endif %}
                    {% if telegram_bot_core_url_webhook %}
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-data-feed">{{ entry_data_link_webhook }}</label>
                        <div class="col-sm-10">
                            <textarea rows="1" id="input-data-feed" class="form-control" readonly>{{ telegram_bot_core_url_webhook }}</textarea>
                        </div>
                    </div>
                    {% endif %}
                 </form>
             </div>
         </div>
     </div>
 </div>
 <script>
    var trigger_value_row = {{ trigger_value_row }};

    function addOptionValue() {
        html  = '<tr id="trigger-value-row' + trigger_value_row + '">';

        html += '  <td class="text-left">';
        {% for language in languages %}
        html += '    <div class="input-group">';
        html += '      <span class="input-group-addon"><img src="language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}" /></span><input type="text" name="telegram_bot_core_trigger_value[' + trigger_value_row + '][trigger_value_keyword_a][{{ language.language_id }}][value]" value="" placeholder="{{ entry_keyword_a }}" class="form-control" />';
        html += '    </div>';
        {% endfor %}
        html += '  </td>';

        html += '  <td class="text-left">';
        {% for language in languages %}
        html += '    <div class="input-group">';
        html += '      <span class="input-group-addon"><img src="language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}" /></span><input type="text" name="telegram_bot_core_trigger_value[' + trigger_value_row + '][trigger_value_keyword_b][{{ language.language_id }}][value]" value="" placeholder="{{ entry_keyword_b }}" class="form-control" />';
        html += '    </div>';
        {% endfor %}
        html += '  </td>';
        
        html += '  <td class="text-right"><select name="telegram_bot_core_trigger_value[' + trigger_value_row + '][role]" class="form-control"><option value="1" selected="selected">{{ text_or }}</option><option value="0">{{ text_and }}</option></select></td>';
        
        html += '  <td class="text-left">';
        {% for language in languages %}
        html += '    <div class="input-group">';
        html += '      <span class="input-group-addon"><img src="language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}" /></span><input type="text" name="telegram_bot_core_trigger_value[' + trigger_value_row + '][trigger_value_description][{{ language.language_id }}][value]" value="" placeholder="{{ entry_answer }}" class="form-control" />';
        html += '    </div>';
        {% endfor %}
        html += '  </td>';
        
        html += '  <td class="text-right"><button type="button" onclick="$(\'#trigger-value-row' + trigger_value_row + '\').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>';
        html += '</tr>';

        $('#trigger-value tbody').append(html);

        trigger_value_row++;
    }
</script>
 {{ footer }}